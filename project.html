<html>
<style>
    table {
        border: 1px
    }
</style>
<body>
    <input onclick="Load()" type="button" value="Load Data" id="myButton" />
    <table id="table"></table>
    <div id='body'></div>
</body>
<script>
    function Load() {
        document.getElementById("myButton").value = "Refresh data";
        this.data = [{
            name: "sahil0",
            middle_name: 'none',
            last_name: "kansal",
            address: 'home',
            email: 'abc@gmail.com',
            phone_no: '123456789',
            role: 'manager'
        },
        {
            name: "john",
            middle_name: 'none',
            last_name: "terry",
            address: 'home',
            email: 'abc@gmail.com',
            phone_no: '123456789',
            role: 'manager'
        },
        {
            name: "luke",
            middle_name: 'none',
            last_name: "shaw",
            address: 'home',
            email: 'abc@gmail.com',
            phone_no: '123456789',
            role: 'manager'
        }
        ]
        col = ['name', 'middle_name', 'last_name', 'address', 'email', 'phone_no', 'role']
        Render()
    }
    var Render = () => {
        document.getElementById("table").innerHTML =`<tr>
        <td>name</td>
        <td>middle name</td>
        <td>last name</td>
        <td>address</td>
        <td>email</td>
        <td>phone no</td>
        <td>role</td>
        <td>`+data.map((id, index) => `
        <tr id="${index+1}">
        <td>${id.name}</td>
        <td>${id.middle_name}</td>
        <td>${id.last_name}</td>
        <td>${id.address}</td>
        <td>${id.email}</td>
        <td>${id.phone_no}</td>
        <td>${id.role}</td>
        <td>
        <button id='${index+1}' value='edit' id='edit' onClick='Edit(${index})'>edit</button>
        </td>
        <td>
        <button id='${index+1}' value='deletee' onClick='Deletee(${index})'>delete</button>
        </td>
        </tr>`).join('')
        var table = document.getElementById("table");
        var rowCount = table.rows.length;
        var row = table.insertRow(rowCount);
        var colCount = table.rows[0].cells.length;
        for (var i = 0; i < 7; i++) {
            var newcell = row.insertCell(i);
            newcell.innerHTML = `<tr><td><input type='text' id='new'></input></td>`;
        };
        var newcell = row.insertCell(7);
        newcell.innerHTML = `<td><button onclick=CreateNew(this)>add</button></td>`;
    }
     var Save=(value)=> {
        var activeRow = value;
        var tab = document.getElementById('table').rows[activeRow];
        var tab = document.getElementById('table').rows[activeRow];
        var obj = {};
        for (i = 0; i < this.col.length; i++) {
            var td = tab.getElementsByTagName("td")[i];
            if (td.childNodes[0].getAttribute('type') == 'text') {     
                var txtVal = td.childNodes[0].value;
                console.log(txtVal)
                if (txtVal != '') {
                    obj[this.col[i]] = txtVal.trim();
                }
                else {
                    obj = '';
                    alert('all fields are compulsory');
                    break;
                }
            }
        }
            this.data[value-1] = obj;             // PUSH (ADD) DATA TO THE JSON ARRAY.
            Render()                            // REFRESH THE TABLE.
    }
    function Deletee(value) {
        data.splice((value), 1);
        Render()
    }
    function Edit(value) {
        var activeRow = value+1;
        var tab = document.getElementById('table').rows[activeRow];
        console.log(activeRow)
        for (i = 0; i < this.col.length; i++) {
            var td = tab.getElementsByTagName("td")[i];
            var ele = document.createElement('input');     
            ele.setAttribute('type', 'text');
            ele.setAttribute('value', td.innerText);
            console.log(td.innerText)
            td.innerText = '';
            td.appendChild(ele);
        }
        tab.getElementsByTagName("td")[7].innerHTML = `<button onclick='Save(${activeRow})'>save</button><button style='margin-left: 3px' onclick='Render()'>discard</button>`
    }
    var CreateNew = function (oButton) {
        var activeRow = oButton.parentNode.parentNode.rowIndex;
        console.log(activeRow)
        var tab = document.getElementById('table').rows[activeRow];
        var obj = {};
        console.log(tab)
        // ADD NEW VALUE TO Data ARRAY.      
        for (i = 0; i < this.col.length; i++) {
            var td = tab.getElementsByTagName("td")[i];
            if (td.childNodes[0].getAttribute('type') == 'text') {      // CHECK IF ELEMENT IS A TEXTBOX OR SELECT.
                var txtVal = td.childNodes[0].value;
                console.log(txtVal)
                if (txtVal != '') {
                    obj[this.col[i]] = txtVal.trim();
                }
                else {
                    obj = '';
                    alert('all fields are compulsory');
                    break;
                }
            }
        }
            data.push(obj);
            Render()    
    }
</script>
</html>